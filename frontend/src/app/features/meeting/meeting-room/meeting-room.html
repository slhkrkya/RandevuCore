<div class="flex h-screen w-full bg-gray-900 text-white overflow-hidden">
  <!-- Main Content Area -->
  <div class="flex-1 flex flex-col relative">
    
    <!-- Meeting Content -->
    <div class="flex-1 relative">
      
      <!-- Video Grid View -->
      <div *ngIf="activeView === 'grid'" class="h-full w-full">
        <app-video-grid 
          [participants]="participants"
          [currentUserId]="currentUserId"
          [localStream]="localStream"
          [remoteStreams]="remoteStreams"
          [meetingState]="meetingState">
        </app-video-grid>
      </div>

      <!-- Speaker View -->
      <div *ngIf="activeView === 'speaker'" class="h-full w-full">
        <app-speaker-view 
          [participants]="participants"
          [currentUserId]="currentUserId"
          [localStream]="localStream"
          [remoteStreams]="remoteStreams"
          [meetingState]="meetingState">
        </app-speaker-view>
      </div>

      <!-- Whiteboard View -->
      <div *ngIf="activeView === 'whiteboard'" class="h-full w-full">
        <app-whiteboard 
          [isActive]="meetingState.isWhiteboardActive"
          [isHost]="isHost"
          [roomKey]="roomKey">
        </app-whiteboard>
      </div>

    </div>

    <!-- Meeting Controls -->
    <app-meeting-controls
      [meetingState]="meetingState"
      [isHost]="isHost"
      [participantsCount]="participants.length"
      [showParticipantsPanel]="showParticipantsPanel"
      [showChatPanel]="showChatPanel"
      [showWhiteboardPanel]="showWhiteboardPanel"
      [activeView]="activeView"
      (toggleMute)="toggleMute()"
      (toggleVideo)="toggleVideo()"
      (toggleScreenShare)="toggleScreenShare()"
      (toggleParticipantsPanel)="toggleParticipantsPanel()"
      (toggleChatPanel)="toggleChatPanel()"
      (toggleWhiteboardPanel)="toggleWhiteboardPanel()"
      (setActiveView)="setActiveView($event)"
      (toggleFullscreen)="toggleFullscreen()"
      (endMeeting)="endMeeting()">
    </app-meeting-controls>

  </div>

  <!-- Participants Panel -->
  <div class="absolute top-0 right-0 h-full w-80 bg-white dark:bg-gray-800 shadow-2xl transform transition-transform duration-300 z-50"
       [class.translate-x-full]="!showParticipantsPanel"
       [class.translate-x-0]="showParticipantsPanel">
    <app-participants-panel
      [participants]="participants"
      [currentUserId]="currentUserId"
      [isHost]="isHost"
      (grantPermission)="grantPermission($event.userId, $event.permission)"
      (removeParticipant)="removeParticipant($event)"
      (close)="toggleParticipantsPanel()">
    </app-participants-panel>
  </div>

  <!-- Chat Panel -->
  <div class="absolute top-0 right-0 h-full w-80 bg-white dark:bg-gray-800 shadow-2xl transform transition-transform duration-300 z-50"
       [class.translate-x-full]="!showChatPanel"
       [class.translate-x-0]="showChatPanel">
    <app-chat-panel
      [roomKey]="roomKey"
      [currentUserId]="currentUserId"
      [currentUserName]="currentUserName"
      (close)="toggleChatPanel()">
    </app-chat-panel>
  </div>

  <!-- Overlay when panels are open -->
  <div *ngIf="showParticipantsPanel || showChatPanel" 
       class="absolute inset-0 bg-black/20 z-40"
       (click)="showParticipantsPanel ? toggleParticipantsPanel() : toggleChatPanel()">
  </div>

  <!-- Connection Status -->
  <div class="absolute top-4 left-4 z-30">
    <div class="flex items-center space-x-2 bg-black/50 px-3 py-2 rounded-lg">
      <div class="w-2 h-2 rounded-full" 
           [class.bg-green-500]="connected"
           [class.bg-red-500]="!connected">
      </div>
      <span class="text-sm">{{ connected ? 'Connected' : 'Connecting...' }}</span>
    </div>
  </div>

  <!-- Meeting Info -->
  <div class="absolute top-4 left-1/2 transform -translate-x-1/2 z-30">
    <div class="bg-black/50 px-4 py-2 rounded-lg text-center">
      <h1 class="text-lg font-semibold">Meeting Room</h1>
      <p class="text-sm text-gray-300">ID: {{ meetingId }}</p>
    </div>
  </div>

</div>