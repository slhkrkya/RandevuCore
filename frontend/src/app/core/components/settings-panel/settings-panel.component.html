<!-- Settings Panel Content -->
<div class="space-y-4">
  <!-- Theme Settings -->
  <div>
    <h3 class="text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">Tema</h3>
    <div class="flex space-x-2">
      <button 
        class="flex-1 px-3 py-2 text-[14px] rounded-md transition-colors"
        [class.bg-blue-500]="currentTheme() === 'light'"
        [class.text-white]="currentTheme() === 'light'"
        [class.bg-slate-200]="currentTheme() !== 'light'"
        [class.dark:bg-slate-700]="currentTheme() !== 'light'"
        [class.text-slate-700]="currentTheme() !== 'light'"
        [class.dark:text-slate-300]="currentTheme() !== 'light'"
        (click)="setTheme('light')">
        <span class="material-symbols-outlined text-sm mr-1">light_mode</span>
        Açık
      </button>
      <button 
        class="flex-1 px-3 py-2 text-[14px] rounded-md transition-colors"
        [class.bg-blue-500]="currentTheme() === 'dark'"
        [class.text-white]="currentTheme() === 'dark'"
        [class.bg-slate-200]="currentTheme() !== 'dark'"
        [class.dark:bg-slate-700]="currentTheme() !== 'dark'"
        [class.text-slate-700]="currentTheme() !== 'dark'"
        [class.dark:text-slate-300]="currentTheme() !== 'dark'"
        (click)="setTheme('dark')">
        <span class="material-symbols-outlined text-sm mr-1">dark_mode</span>
        Koyu
      </button>
      <button 
        class="flex-1 px-3 py-2 text-[14px] rounded-md transition-colors"
        [class.bg-blue-500]="currentTheme() === 'system'"
        [class.text-white]="currentTheme() === 'system'"
        [class.bg-slate-200]="currentTheme() !== 'system'"
        [class.dark:bg-slate-700]="currentTheme() !== 'system'"
        [class.text-slate-700]="currentTheme() !== 'system'"
        [class.dark:text-slate-300]="currentTheme() !== 'system'"
        (click)="setTheme('system')">
        <span class="material-symbols-outlined text-sm mr-1">computer</span>
        Sistem
      </button>
    </div>
  </div>

  <!-- Device Settings -->
  <div>
    <h3 class="text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">Cihaz Ayarları</h3>
    
    <!-- Camera Selection -->
    <div class="mb-3">
      <label class="block text-[14px] text-slate-600 dark:text-slate-400 mb-1">Kamera</label>
      <div *ngIf="!hasCameraPermission()" class="mb-2">
        <div class="flex items-center p-2 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-md">
          <span class="material-symbols-outlined text-amber-600 dark:text-amber-400 text-sm mr-2">warning</span>
          <span class="text-[14px] text-amber-700 dark:text-amber-300">Kamera izni gerekli</span>
          <button 
            class="ml-auto px-2 py-1 text-[14px] bg-amber-600 hover:bg-amber-700 text-white rounded transition-colors"
            (click)="requestCameraPermission()">
            İzin Ver
          </button>
        </div>
      </div>
      <select 
        *ngIf="hasCameraPermission()"
        class="w-full px-3 py-2 text-[14px] bg-slate-100 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
        [ngModel]="deviceSettings().cameraDeviceId || ''"
        (ngModelChange)="setCameraDevice($event || null)">
        <option value="">Varsayılan Kamera</option>
        <option *ngFor="let camera of availableCameras()" [value]="camera.deviceId">
          {{ getDeviceName(camera) }}
        </option>
      </select>
    </div>

    <!-- Microphone Selection -->
    <div class="mb-3">
      <label class="block text-[14px] text-slate-600 dark:text-slate-400 mb-1">Mikrofon</label>
      <div *ngIf="!hasMicrophonePermission()" class="mb-2">
        <div class="flex items-center p-2 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-md">
          <span class="material-symbols-outlined text-amber-600 dark:text-amber-400 text-sm mr-2">warning</span>
          <span class="text-[14px] text-amber-700 dark:text-amber-300">Mikrofon izni gerekli</span>
          <button 
            class="ml-auto px-2 py-1 text-[14px] bg-amber-600 hover:bg-amber-700 text-white rounded transition-colors"
            (click)="requestMicrophonePermission()">
            İzin Ver
          </button>
        </div>
      </div>
      <select 
        *ngIf="hasMicrophonePermission()"
        class="w-full px-3 py-2 text-[14px] bg-slate-100 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
        [ngModel]="deviceSettings().microphoneDeviceId || ''"
        (ngModelChange)="setMicrophoneDevice($event || null)">
        <option value="">Varsayılan Mikrofon</option>
        <option *ngFor="let mic of availableMicrophones()" [value]="mic.deviceId">
          {{ getDeviceName(mic) }}
        </option>
      </select>
    </div>

    <!-- Speaker Selection -->
    <div class="mb-3">
      <label class="block text-[14px] text-slate-600 dark:text-slate-400 mb-1">Hoparlör</label>
      <select 
        class="w-full px-3 py-2 text-[14px] bg-slate-100 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
        [ngModel]="deviceSettings().speakerDeviceId || ''"
        (ngModelChange)="setSpeakerDevice($event || null)">
        <option value="">Varsayılan Hoparlör</option>
        <option *ngFor="let speaker of availableSpeakers()" [value]="speaker.deviceId">
          {{ getDeviceName(speaker) }}
        </option>
      </select>
    </div>

    <!-- Microphone Volume -->
    <div *ngIf="hasMicrophonePermission()">
      <div class="volume-label">
        <span>Mikrofon Ses Seviyesi</span>
        <div class="flex items-center space-x-2">
          <span class="volume-percentage">{{ deviceSettings().microphoneVolume }}%</span>
          <button 
            class="btn btn-sm rounded-full p-1"
            [class.bg-red-500]="isAudioMuted()"
            [class.bg-green-500]="!isAudioMuted()"
            (click)="toggleAudioMute()"
            title="Mikrofonu Aç/Kapat">
            <span class="material-symbols-outlined text-white text-[14px]">
              {{ isAudioMuted() ? 'mic_off' : 'mic' }}
            </span>
          </button>
        </div>
      </div>
      <div class="slider-wrapper">
        <div class="level-overlay" [style.width.%]="currentAudioVolume()"></div>
        <input 
          type="range" 
          min="0" 
          max="100" 
          [ngModel]="deviceSettings().microphoneVolume"
          (ngModelChange)="setMicrophoneVolume($event)"
          class="w-full slider">
      </div>
      
      <!-- Audio Test Button (Press-and-hold) -->
      <div class="mt-2">
        <button 
          class="w-full px-3 py-2 text-[14px] rounded-md transition-colors"
          [class.bg-green-500]="isAudioListening()"
          [class.hover:bg-green-600]="isAudioListening()"
          [class.bg-blue-500]="!isAudioListening()"
          [class.hover:bg-blue-600]="!isAudioListening()"
          [class.text-white]="true"
          (pointerdown)="startAudioMonitoring()"
          (pointerup)="stopAudioMonitoring()"
          (pointerleave)="stopAudioMonitoring()"
          (contextmenu)="$event.preventDefault()"
        >
          <span class="material-symbols-outlined text-sm mr-1 align-middle">
            {{ isAudioListening() ? 'mic_off' : 'mic' }}
          </span>
          {{ isAudioListening() ? 'Basılı tutmayı bırakmak için bırakın' : 'Basılı tutarak Mikrofona Test Et' }}
        </button>
      </div>
    </div>

    <!-- Speaker Monitor Volume (App-wide) -->
    <div class="mt-4">
      <div class="volume-label">
        <span>Hoparlör Ses Seviyesi</span>
        <span class="volume-percentage">{{ speakerMonitorVolume() }}%</span>
      </div>
      <input
        type="range"
        min="0"
        max="100"
        [ngModel]="speakerMonitorVolume()"
        (ngModelChange)="setSpeakerMonitorVolume($event)"
        class="w-full slider">
      <div class="text-[12px] text-slate-500 dark:text-slate-400 mt-1">
        Bu ayar tüm uygulamada izleme sesini etkiler.
      </div>
    </div>
  </div>
</div>
