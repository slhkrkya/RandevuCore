<header class="w-full bg-white/80 dark:bg-slate-900/80 border-b border-slate-200/50 dark:border-slate-700/50 shadow-sm backdrop-blur-md fixed top-0 left-0 z-50 min-h-12 flex items-center">
  <nav class="container mx-auto px-4 sm:px-6 py-6 flex items-center justify-between">
    <!-- Left Section: Logo and Navigation -->
    <div class="flex items-center space-x-2 sm:space-x-4">
      <div class="w-6 h-6 sm:w-8 sm:h-8 gradient-primary rounded-lg flex items-center justify-center animate-scale-in">
        <span class="material-symbols-outlined text-white text-sm sm:text-base">calendar_month</span>
      </div>
      <h1 class="text-lg sm:text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 dark:from-blue-500 dark:to-purple-500 bg-clip-text text-transparent animate-fade-in">RandevuCore</h1>
      
      <!-- Desktop Navigation - Only show when authenticated -->
      <div class="hidden lg:flex items-center space-x-2 ml-4" *ngIf="isAuthenticated()">
        <a routerLink="/appointments" 
           routerLinkActive="active-nav-link" 
           [routerLinkActiveOptions]="{exact: true}"
           class="nav-link animate-fade-in animate-delay-1">
          <span class="material-symbols-outlined text-sm mr-1 align-middle">event_note</span>
          <span class="hidden xl:inline">Randevular</span>
        </a>
        <a routerLink="/meetings" 
           routerLinkActive="active-nav-link" 
           class="nav-link animate-fade-in animate-delay-2">
          <span class="material-symbols-outlined text-sm mr-1 align-middle">video_call</span>
          <span class="hidden xl:inline">Toplantılar</span>
        </a>
      </div>
    </div>

    <!-- Center Section: Current Page Title (Desktop) - Only show when authenticated -->
    <div class="flex-1 text-center hidden xl:block" *ngIf="isAuthenticated()">
      <span class="badge badge-primary animate-fade-in animate-delay-3">
        <ng-container *ngIf="getCurrentPageTitle() as title">{{ title }}</ng-container>
      </span>
    </div>

    <!-- Mobile Page Title - Show in navbar when authenticated -->
    <div class="flex-1 text-center lg:hidden" *ngIf="isAuthenticated()">
      <span class="badge badge-primary text-[14px]">
        <ng-container *ngIf="getCurrentPageTitle() as title">{{ title }}</ng-container>
      </span>
    </div>

    <!-- Right Section: User Actions -->
    <div class="flex items-center space-x-2 sm:space-x-3">
      <ng-container *ngIf="isAuthenticated(); else guest">
        <!-- Desktop User Buttons (only on lg and above) -->
        <div class="hidden lg:flex items-center space-x-2">
          <!-- User Profile Button -->
          <button class="btn btn-secondary btn-sm rounded-full p-2 animate-fade-in animate-delay-4"
                  (click)="navigateToProfile()"
                  title="Profil">
            <span class="material-symbols-outlined text-base">person</span>
          </button>
          
          <!-- Settings Button -->
          <div class="relative">
            <button class="btn btn-secondary btn-sm rounded-full p-2 animate-fade-in animate-delay-5"
                    (click)="toggleSettingsMenu()"
                    title="Ayarlar">
              <span class="material-symbols-outlined text-base">settings</span>
            </button>
            
            <!-- Settings Dropdown Menu -->
            <div *ngIf="isSettingsMenuOpen()" 
                 class="absolute top-full right-0 mt-2 w-80 bg-white/95 dark:bg-slate-800/95 border border-slate-200 dark:border-slate-700 shadow-xl rounded-lg z-50 backdrop-blur-md animate-fade-in">
              <div class="p-4">
                <app-settings-panel></app-settings-panel>

                <!-- Settings Actions -->
                <div class="pt-2 border-t border-slate-200 dark:border-slate-700 mt-4">
                  <button 
                    class="w-full px-3 py-2 text-[14px] text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200 transition-colors"
                    (click)="navigateToSettings(); closeSettingsMenu()">
                    <span class="material-symbols-outlined text-sm mr-1 align-middle">settings</span>
                    Tüm Ayarlar
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Logout Button -->
          <button class="btn btn-danger btn-sm animate-fade-in animate-delay-6"
                  (click)="logout()">
            <span class="material-symbols-outlined text-sm mr-1">logout</span>
            <span class="hidden xl:inline">Çıkış</span>
          </button>
        </div>

        <!-- Mobile Actions (only on lg below) -->
        <div class="lg:hidden flex items-center space-x-2">
          <!-- Burger Menu Button -->
          <button 
            class="btn btn-secondary btn-sm rounded-full p-2 animate-fade-in animate-delay-4"
            (click)="isMobileMenuOpen ? closeMobileMenu() : toggleMobileMenu()"
            title="Menü"
          >
            <span class="material-symbols-outlined text-base">{{ isMobileMenuOpen ? 'close' : 'menu' }}</span>
          </button>
        </div>
      </ng-container>
      
      <ng-template #guest>
        <div class="hidden lg:flex items-center space-x-3">
          <a routerLink="/login" 
             class="btn btn-secondary btn-sm animate-fade-in animate-delay-4">
            <span class="material-symbols-outlined text-sm mr-1">login</span>
            <span class="hidden xl:inline">Giriş</span>
          </a>
          <a routerLink="/register" 
             class="btn btn-primary btn-sm animate-fade-in animate-delay-5">
            <span class="material-symbols-outlined text-sm mr-1">person_add</span>
            <span class="hidden xl:inline">Kayıt Ol</span>
          </a>
        </div>
        
        <!-- Mobile Guest Actions -->
        <div class="lg:hidden flex items-center space-x-2">
          <button 
            class="btn btn-secondary btn-sm animate-fade-in animate-delay-4"
            (click)="isMobileMenuOpen ? closeMobileMenu() : toggleMobileMenu()"
            title="Menü"
          >
            <span class="material-symbols-outlined text-base">{{ isMobileMenuOpen ? 'close' : 'menu' }}</span>
          </button>
        </div>
      </ng-template>
    </div>
  </nav>

  <!-- Mobile Dropdown Menu -->
  <div *ngIf="isMobileMenuOpen" 
       class="lg:hidden absolute top-full right-0 left-0 bottom-0 bg-black bg-opacity-25 backdrop-blur-sm z-50 animate-fade-in"
       (click)="closeMobileMenu()">
    <div class="lg:hidden absolute top-full right-4 w-64 bg-white/95 dark:bg-slate-800/95 border border-slate-200 dark:border-slate-700 shadow-xl rounded-t-none rounded-b-lg z-[60] backdrop-blur-md"
         [class.animate-paper-fold-down]="!isClosing"
         [class.animate-paper-fold-up]="isClosing"
         (click)="$event.stopPropagation()">
      <div class="p-4">
        
        <!-- Mobile Navigation Links - Only show when authenticated -->
        <div class="space-y-2 mb-4" *ngIf="isAuthenticated()">
          <a routerLink="/appointments" 
             routerLinkActive="active-nav-link mobile"
             [routerLinkActiveOptions]="{exact: true}"
             class="mobile-nav-link block"
             (click)="closeMobileMenu()">
            <span class="material-symbols-outlined text-sm mr-2">event_note</span>
            Randevular
          </a>
          <a routerLink="/meetings" 
             routerLinkActive="active-nav-link mobile"
             class="mobile-nav-link block"
             (click)="closeMobileMenu()">
            <span class="material-symbols-outlined text-sm mr-2">video_call</span>
            Toplantılar
          </a>
        </div>


        <!-- Mobile User Actions -->
        <ng-container *ngIf="isAuthenticated(); else mobileGuest">
          <div class="space-y-2">
            <button 
              class="mobile-nav-link w-full flex items-center text-sm"
              (click)="navigateToProfile(); closeMobileMenu()">
              <span class="material-symbols-outlined text-sm mr-2">person</span>
              Profil
            </button>
            <button 
              class="mobile-nav-link w-full flex items-center text-sm"
              (click)="toggleSettingsMenu(); closeMobileMenu()">
              <span class="material-symbols-outlined text-sm mr-2">settings</span>
              Ayarlar
            </button>
            <button 
              class="mobile-nav-link w-full flex items-center text-sm text-red-600 dark:text-red-400"
              (click)="logout(); closeMobileMenu()">
              <span class="material-symbols-outlined text-sm mr-2">logout</span>
              Çıkış Yap
            </button>
          </div>
        </ng-container>
        
        <ng-template #mobileGuest>
          <div class="space-y-2">
            <a routerLink="/login" 
               class="mobile-nav-link block text-sm"
               (click)="closeMobileMenu()">
              <span class="material-symbols-outlined text-sm mr-2">login</span>
              Giriş Yap
            </a>
            <a routerLink="/register" 
               class="mobile-nav-link block text-sm text-blue-600 dark:text-blue-400"
               (click)="closeMobileMenu()">
              <span class="material-symbols-outlined text-sm mr-2">person_add</span>
              Kayıt Ol
            </a>
          </div>
        </ng-template>
      </div>
    </div>
  </div>

  <!-- Mobile Settings Panel -->
  <div *ngIf="isSettingsMenuOpen()" 
       class="lg:hidden fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm z-50 animate-fade-in">
    <div class="absolute top-0 right-0 w-full max-w-md h-full bg-white/95 dark:bg-slate-800/95 border-l border-slate-200 dark:border-slate-700 shadow-xl backdrop-blur-md animate-slide-in-right" style="min-width: 320px;">
      <div class="p-4 h-full overflow-y-auto">
        <!-- Header -->
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-lg font-semibold text-slate-800 dark:text-slate-200">Ayarlar</h2>
          <button 
            class="btn btn-secondary btn-sm rounded-full p-2"
            (click)="closeSettingsMenu()">
            <span class="material-symbols-outlined text-base">close</span>
          </button>
        </div>

        <!-- Settings Panel -->
        <div class="mb-6">
          <app-settings-panel></app-settings-panel>
        </div>

        <!-- Settings Actions -->
        <div class="pt-4 border-t border-slate-200 dark:border-slate-700">
          <button 
            class="w-full flex items-center px-4 py-3 text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200 transition-colors rounded-lg"
            (click)="navigateToSettings(); closeSettingsMenu()">
            <span class="material-symbols-outlined text-lg mr-3">settings</span>
            <div class="text-left">
              <div class="font-medium">Tüm Ayarlar</div>
              <div class="text-[14px] opacity-75">Detaylı ayar seçenekleri</div>
            </div>
          </button>
        </div>
      </div>
    </div>
  </div>
</header>